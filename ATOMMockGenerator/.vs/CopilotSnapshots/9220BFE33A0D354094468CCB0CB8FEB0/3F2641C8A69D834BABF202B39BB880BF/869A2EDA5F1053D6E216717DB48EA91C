import React, { useState } from 'react';
import Layout from './components/Layout';
import FileUpload from './components/upload/FileUpload';
import MappingList from './components/manage/MappingList';
import { JsonConfig, User } from './types';
import './App.css';

// Mock current user - in a real app, this would come from authentication
const mockUser: User = {
  id: '1',
  username: 'admin',
  role: 'Admin'
};

function App() {
  const [activeTab, setActiveTab] = useState<'upload' | 'manage'>('upload');
  const [currentConfig, setCurrentConfig] = useState<JsonConfig | null>(null);

  const handleConfigUploaded = (config: JsonConfig) => {
    setCurrentConfig(config);
    // Auto-switch to manage tab after successful upload
    setActiveTab('manage');
  };

  return (
    <Layout activeTab={activeTab} onTabChange={setActiveTab}>
      {activeTab === 'upload' ? (
        <div>
          <div className="mb-6">
            <h2 className="text-2xl font-bold text-gray-900">Upload Wiremock Configuration</h2>
            <p className="mt-2 text-gray-600">
              Upload your JSON configuration file to generate Wiremock mappings and responses.
            </p>
          </div>
          <FileUpload onConfigUploaded={handleConfigUploaded} />
        </div>
      ) : (
        <div>
          <div className="mb-6">
            <h2 className="text-2xl font-bold text-gray-900">Manage Wiremock Mappings</h2>
            <p className="mt-2 text-gray-600">
              View, edit, delete, and download your generated Wiremock mappings.
            </p>
          </div>
          <MappingList currentUser={mockUser} />
        </div>
      )}
    </Layout>
  );
}

export default App;
